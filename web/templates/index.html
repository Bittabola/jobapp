<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JobApp - Cover Letter Generator</title>
    <link rel="stylesheet" href="/static/css/style.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>Cover Letter Generator</h1>
            <p class="subtitle">Generate a tailored cover letter in seconds</p>
        </header>

        <main>
            <!-- Form Section -->
            <form id="generate-form" enctype="multipart/form-data">
                <!-- Step 1: Job Info -->
                <section class="form-section">
                    <h2>1. Job Information</h2>
                    
                    <!-- Toggle between URL and Manual input -->
                    <div class="input-toggle">
                        <button type="button" class="toggle-btn active" data-mode="url">Paste URL</button>
                        <button type="button" class="toggle-btn" data-mode="manual">Enter Manually</button>
                    </div>

                    <!-- URL Input -->
                    <div class="input-mode" id="url-mode">
                        <label for="job_url">Job Posting URL</label>
                        <input type="url" id="job_url" name="job_url" 
                               placeholder="https://linkedin.com/jobs/view/...">
                        <p class="hint">Works best with LinkedIn job postings</p>
                    </div>

                    <!-- Manual Input -->
                    <div class="input-mode hidden" id="manual-mode">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="job_title">Job Title</label>
                                <input type="text" id="job_title" name="job_title" 
                                       placeholder="Marketing Manager">
                            </div>
                            <div class="form-group">
                                <label for="company_name">Company Name</label>
                                <input type="text" id="company_name" name="company_name" 
                                       placeholder="Acme Corp">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="job_description">Job Description</label>
                            <textarea id="job_description" name="job_description" rows="6"
                                      placeholder="Paste the job description here..."></textarea>
                        </div>
                    </div>
                </section>

                <!-- Step 2: Custom Instructions -->
                <section class="form-section">
                    <h2>2. Custom Instructions <span class="optional">(optional)</span></h2>
                    <textarea id="instructions" name="instructions" rows="3"
                              placeholder="E.g., Emphasize my HubSpot experience..."></textarea>
                </section>

                <!-- Advanced Settings (collapsible) -->
                <section class="form-section accordion-section">
                    <button type="button" class="accordion-toggle" id="advanced-toggle">
                        <span class="toggle-icon">&#9654;</span>
                        Advanced Settings
                    </button>
                    
                    <div class="accordion-content hidden" id="advanced-content">
                        <div class="form-group">
                            <label for="prompt">
                                AI Prompt
                                <span class="label-hint">Customize how the AI writes your cover letter</span>
                            </label>
                            <textarea id="prompt" rows="12" 
                                      placeholder="Loading prompt..."></textarea>
                            
                            <div class="prompt-actions">
                                <button type="button" class="btn-secondary" id="save-prompt-btn">
                                    Save Changes
                                </button>
                                <span class="prompt-status" id="prompt-status"></span>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Submit Button -->
                <button type="submit" class="submit-btn" id="submit-btn">
                    Generate Cover Letter
                </button>
            </form>

            <!-- Progress Section (hidden by default) -->
            <section class="progress-section hidden" id="progress-section">
                <h2>Generating your cover letter...</h2>
                <div class="progress-steps">
                    <div class="step" data-step="job">
                        <span class="step-icon"></span>
                        <span class="step-text">Fetching job details</span>
                    </div>
                    <div class="step" data-step="generate">
                        <span class="step-icon"></span>
                        <span class="step-text">Generating with AI</span>
                    </div>
                    <!-- Humanization step paused - uncomment when re-enabled
                    <div class="step" data-step="humanize">
                        <span class="step-icon"></span>
                        <span class="step-text">Humanizing text</span>
                    </div>
                    -->
                    <div class="step" data-step="render">
                        <span class="step-icon"></span>
                        <span class="step-text">Rendering HTML</span>
                    </div>
                    <div class="step" data-step="pdf">
                        <span class="step-icon"></span>
                        <span class="step-text">Creating PDF</span>
                    </div>
                    <div class="step" data-step="merge">
                        <span class="step-icon"></span>
                        <span class="step-text">Merging documents</span>
                    </div>
                </div>
                <p class="progress-note">This usually takes 15-30 seconds...</p>
            </section>

            <!-- Result Section (hidden by default) -->
            <section class="result-section hidden" id="result-section">
                <div class="result-success">
                    <div class="success-icon">&#10003;</div>
                    <h2>Your cover letter is ready!</h2>
                    <p class="result-meta">
                        <strong id="result-title"></strong> at <strong id="result-company"></strong>
                    </p>
                    <a href="#" class="download-btn" id="download-btn">Download PDF</a>
                    <button type="button" class="reset-btn" id="reset-btn">Generate Another</button>
                </div>
            </section>

            <!-- Error Section (hidden by default) -->
            <section class="error-section hidden" id="error-section">
                <div class="error-content">
                    <div class="error-icon">!</div>
                    <h2>Something went wrong</h2>
                    <p class="error-message" id="error-message"></p>
                    <button type="button" class="retry-btn" id="retry-btn">Try Again</button>
                </div>
            </section>
        </main>

        <footer>
            <p>Powered by Google Gemini AI</p>
        </footer>
    </div>

    <script src="/static/js/app.js"></script>
</body>
</html>
